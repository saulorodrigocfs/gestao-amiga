{% extends 'base.html' %}
{% block content%}
<h2>Relat√≥rio de Lucros</h2>

<form method="get">
    {{ form.as_p }}
    <button type="submit" class="btn btn-primary">Aplicar Filtros</button>
</form>

<table class="table">
    <thead>
        <tr>
            <th>Data</th>
            <th>Cliente</th>
            <th>Forma de Pagamento</th>
            <th>Produto</th>
            <th>Quantidade Vendida</th>
            <th>Total Receita</th>
            <th>Total Custo</th>
            <th>Lucro</th>
        </tr>
    </thead>
    <tbody>
        {% for item in relatorio %}
        <tr>
            <td>{{ item.data|date:"d/m/Y" }}</td>
            <td>{{ item.cliente }}</td>
            <td>{{ item.forma_pagamento }}</td>
            <td>{{ item.produto }}</td>
            <td>{{ item.quantidade_vendida }}</td>
            <td>{{ item.total_receita }}</td>
            <td>{{ item.total_custo }}</td>
            <td>{{ item.lucro }}</td>
        </tr>
        {% empty %}
        <tr>
            <td colspan="7"><em>Nenhum resultado encontrado.</em></td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<form method="post" action="{% url 'exportar_relatorio_pdf' loja_id=loja_id %}">
    {% csrf_token %}
    <input type="hidden" name="data_inicio" value="{{ request.GET.data_inicio }}">
    <input type="hidden" name="data_fim" value="{{ request.GET.data_fim }}">
    <input type="hidden" name="cliente" value="{{ request.GET.cliente }}">
    <input type="hidden" name="produto" value="{{ request.GET.produto }}">
    <button type="submit" class="btn btn-success">Exportar PDF</button>
</form>

<a href="{% url 'dashboard_loja' loja_id %}" class="btn btn-secondary">Voltar ao Dashboard</a>
{% endblock %}
